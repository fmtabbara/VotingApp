{"version":3,"sources":["components/bar/bar.jsx","reducer.js","App.js","index.js"],"names":["Bar","isDisabled","addVote","background","party","value","vote","className","disabled","type","name","onClick","style","cursor","width","LOAD_DATA","ADD_VOTE","initialState","parties","color","votes","totalVotes","isInitialised","partiesReducer","state","action","newState","forEach","data","filter","item","match","url","App","React","useReducer","dispatch","useEffect","fetch","Accept","then","res","json","catch","err","console","log","weight","window","innerWidth","useState","handleIsDisabled","handleSelect","target","checked","opts","method","headers","body","JSON","stringify","ok","makeRequest","left","map","index","key","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.831c63fd.chunk.js","sourcesContent":["import React from \"react\";\r\nimport \"./styles.css\";\r\n\r\nconst Bar = ({ isDisabled, addVote, background, party, value, vote }) => {\r\n  return (\r\n    <div className=\"vote__container\">\r\n      <input\r\n        className=\"vote__input\"\r\n        disabled={isDisabled}\r\n        type=\"checkbox\"\r\n        name={party}\r\n        onClick={addVote}\r\n        style={{cursor:isDisabled ? \"\" : \"pointer\"}}\r\n      />\r\n      <div className=\"vote__value\">{vote}</div>\r\n      <div>\r\n        <div className=\"vote__party\">{party}</div>\r\n        <div className=\"vote__bar\" style={{ background, width: value }} />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Bar;\r\n","export const LOAD_DATA = \"LOAD_DATA\";\r\nexport const ADD_VOTE = \"ADD_VOTE\";\r\n\r\nexport const initialState = {\r\n  parties: [\r\n    {name: \"LABOUR\", color: \"#E4003B\", votes: 0},\r\n    {name: \"CONSERVATIVES\", color: \"#0066ff\", votes: 0},\r\n    {name: \"LIBDEMS\", color: \"#FFAE27\", votes: 0},\r\n    {name: \"GREEN\", color: \"green\", votes: 0},\r\n    {name: \"BREXIT\", color: \"purple\", votes: 0},\r\n    {name: \"OTHER\", color: \"black\", votes: 0}\r\n  ],\r\n  totalVotes: 1,\r\n  isInitialised: false,\r\n}\r\n\r\nexport const partiesReducer = (state, action) => {\r\n  const newState = {...state};\r\n  let parties;\r\n  let totalVotes;\r\n  let isInitialised;\r\n\r\n  switch (action.type) {\r\n    case LOAD_DATA:\r\n      parties = [...newState.parties];\r\n      totalVotes = newState.totalVotes;\r\n      isInitialised = true;\r\n\r\n      parties.forEach((party) => {\r\n        const [match] = action.data.filter(item => party.name === item.name)\r\n        if (match) {\r\n          party.votes = match.votes;\r\n          totalVotes += match.votes;\r\n        }\r\n      });\r\n\r\n      return {...newState, parties, totalVotes, isInitialised};\r\n\r\n    case ADD_VOTE:\r\n      parties = [...newState.parties];\r\n      totalVotes = newState.totalVotes;\r\n\r\n      parties.forEach(party => {\r\n        if(party.name === action.party) {\r\n          party.votes += 1;\r\n          totalVotes += 1;\r\n        }\r\n      });\r\n      return {...newState, totalVotes, parties}\r\n\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n","import React from 'react';\r\nimport Bar from './components/bar/bar';\r\nimport { partiesReducer, initialState, LOAD_DATA, ADD_VOTE } from './reducer';\r\nimport './App.css';\r\n\r\nconst url = process.env.NODE_ENV === \"development\" ? \"http://localhost:4001/api\" : \"/api\"\r\n\r\nexport const enumParties = {\r\n  LABOUR: \"LABOUR\",\r\n  CONSERVATIVES: \"CONSERVATIVES\",\r\n  LIBDEMS: \"LIBDEMS\",\r\n  GREEN: \"GREEN\",\r\n  BREXIT: \"BREXIT\",\r\n  OTHER: \"OTHER\",\r\n\r\n};\r\n\r\nfunction App() {\r\n\r\n  const [state, dispatch] = React.useReducer(partiesReducer, initialState)\r\n\r\n  React.useEffect(() => {\r\n    fetch(url, {Accept: \"application/json\"})\r\n      .then(res => {\r\n        res.json()\r\n          .then(data => {\r\n            dispatch({type: LOAD_DATA, data})\r\n          })\r\n          .catch(err => console.log(err));\r\n      })\r\n      .catch(err => console.log(err));\r\n  }, []);\r\n\r\n  const weight = window.innerWidth\r\n\r\n  const [isDisabled, handleIsDisabled] = React.useState(false);\r\n\r\n  const makeRequest = (party) => {\r\n    const opts = {\r\n      method:\"POST\",\r\n      headers: { 'Content-type': 'application/json'},\r\n      body: JSON.stringify({party}),\r\n    }\r\n    fetch(url, opts)\r\n      .then(res => res.ok)\r\n      .catch(err => console.log(err))\r\n  };\r\n  \r\n  const setDisabled = () => {\r\n    handleIsDisabled(true);\r\n  };\r\n\r\n  const handleSelect = ({ target: { name, checked } }) => {\r\n    if (checked) {\r\n      dispatch({type: ADD_VOTE, party: name})\r\n      makeRequest(name)\r\n      setDisabled(true);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      <div className=\"content\" style={{left: weight/4}}>\r\n        <div className=\"title\">The People's Poll - UK General Election 2019</div>\r\n        {state.isInitialised ?\r\n        <div className=\"bar-chart\">\r\n          {state.parties.map((party, index) => {\r\n            return (\r\n              <Bar\r\n                isDisabled={isDisabled}\r\n                addVote={handleSelect}\r\n                party={party.name}\r\n                vote={party.votes}\r\n                background={party.color}\r\n                value={(party.votes / state.totalVotes) * weight}\r\n                key={index}\r\n              />\r\n            )\r\n          })}\r\n        </div>\r\n        : \"Loading...\"}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './App';\r\n\r\nReactDOM.render(<App />, document.getElementById('root'));"],"sourceRoot":""}